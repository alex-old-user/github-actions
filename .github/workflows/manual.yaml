name: 'CI'
on: 
  workflow_dispatch:
    inputs:
      releaseTag:
        description: 'release tag'     
        required: true


jobs:
  release:
    # if: startsWith(github.ref, 'refs/tags/')
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - run: git log -5
      # - name: Build Changelog
      #   id: github_release
      #   uses: mikepenz/release-changelog-builder-action@v3

      - uses: azure/setup-helm@v3
        with:
          version: 3.11.1

      - uses: helm/chart-releaser-action@v1
        env:
          CR_TOKEN: "${{ secrets.GITHUB_TOKEN }}"
          CR_SKIP_EXISTING: true
        with:
          charts_dir: deploy
          version: ${{ github.event.inputs.releaseTag }}

        


      # - name: Release
      #   uses: softprops/action-gh-release@v1
      #   # if: startsWith(github.ref, 'refs/tags/')
      #   with:
      #     draft: true
      #     files: test
      #     tag_name: ${{ github.event.inputs.releaseTag }}
      #     generate_release_notes: true
      #     #body: ${{steps.github_release.outputs.changelog}}
